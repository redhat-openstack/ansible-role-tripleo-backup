---
# Add the virthost to the in-memory inventory. The inventory is not
# written out to disk unless you call the `tripleo-inventory` role.
- name: Add the virthost to the inventory
  hosts: localhost
  tasks:
    - name: Add virthost
      add_host:
        name: "{{virthost}}"
        groups: "virthost"
        ansible_fqdn: "{{ virthost }}"
        ansible_user: "root"
        ansible_host: "{{ virthost }}"

- name: Sanity checks the undercloud services
  hosts: undercloud
  gather_facts: no
  tags:
    - tripleo-restore-uc-sanity
  roles:
    - { role: tripleo-backup,
        sanity: true,
        services: ["openstack-glance-api"] }

- name: Sanity checks the overcloud services
  hosts: controller
  gather_facts: no
  tags:
    - tripleo-restore-oc-sanity
  roles:
    - { role: tripleo-backup,
        sanity: true,
        services: ["openstack-glance-api", "neutron-server"] }
